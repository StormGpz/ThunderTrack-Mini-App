# Hyperliquid é›†æˆæ¶æ„æ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. **Farcaster é’±åŒ…é›†æˆ** âœ“
- âœ… å®ç°äº† Farcaster Mini App SDK é›†æˆ
- âœ… æ”¯æŒå†…ç½®é’±åŒ…åœ°å€è‡ªåŠ¨è·å–ï¼ˆeth_accounts æ–¹æ³•ï¼‰
- âœ… å®ç°äº†äº¤æ˜“ç¡®è®¤å¯¹è¯æ¡†åŠŸèƒ½
- âœ… å®Œæˆäº† EIP-712 ç­¾ååŠŸèƒ½æ¡†æ¶

### 2. **Hyperliquid æœåŠ¡å±‚** âœ“
- âœ… Info API é›†æˆï¼šè·å–ç”¨æˆ·çŠ¶æ€ã€äº¤æ˜“å†å²ã€å¸‚åœºæ•°æ®
- âœ… Exchange API é›†æˆï¼šä¸‹å•ã€å–æ¶ˆè®¢å•
- âœ… åœ°å€æˆæƒç®¡ç†ç³»ç»Ÿ
- âœ… EIP-712 ç­¾åç”Ÿæˆï¼ˆç»“æ„åŒ–æ•°æ®æ„é€ ï¼‰
- âœ… æœ¬åœ°å­˜å‚¨ï¼ˆSharedPreferencesï¼‰

### 3. **äº¤æ˜“ Provider** âœ“
- âœ… åˆ›å»º HyperliquidTradingProvider ç®¡ç†äº¤æ˜“çŠ¶æ€
- âœ… é›†æˆå¼‚æ­¥æ“ä½œå’Œé”™è¯¯å¤„ç†
- âœ… æä¾›ä¸‹å•ã€å–æ¶ˆè®¢å•ã€åˆ·æ–°è®¢å•ç­‰æ–¹æ³•

### 4. **UI ç•Œé¢åŸºç¡€** âœ“
- âœ… äº¤æ˜“é¡µé¢ï¼ˆTradingPageï¼‰
- âœ… åœ°å€é€‰æ‹©ç»„ä»¶
- âœ… äº¤æ˜“è¡¨å•ç»„ä»¶

## ğŸ—ï¸ æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç”¨æˆ·ç•Œé¢å±‚ (UI)                         â”‚
â”‚  TradingPage - ä¸‹å• - è®¢å•åˆ—è¡¨ - æŒä»“                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              çŠ¶æ€ç®¡ç†å±‚ (Provider)                           â”‚
â”‚  HyperliquidTradingProvider - UserProvider                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ä¸šåŠ¡é€»è¾‘å±‚ (Service)                            â”‚
â”‚  HyperliquidService - Farcasteré’±åŒ…æœåŠ¡                     â”‚
â”‚  â”œâ”€ Info API (è·å–æ•°æ®)                                    â”‚
â”‚  â”œâ”€ Exchange API (æ‰§è¡Œäº¤æ˜“)                                â”‚
â”‚  â”œâ”€ EIP-712 ç­¾å                                           â”‚
â”‚  â””â”€ åœ°å€æˆæƒç®¡ç†                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            åŒºå—é“¾äº¤äº’å±‚ (Web3)                              â”‚
â”‚  Farcaster å†…ç½®é’±åŒ… - äº¤æ˜“ç­¾å - API è°ƒç”¨                  â”‚
â”‚  Hyperliquid API (https://api.hyperliquid.xyz)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”‘ å…³é”®æŠ€æœ¯ç‚¹

### 1. **EIP-712 ç­¾å**
```dart
// ç»“æ„åŒ–æ•°æ®æ ¼å¼
{
  'types': {
    'EIP712Domain': [...],
    'HyperliquidTransaction': [...]
  },
  'domain': {
    'name': 'Hyperliquid',
    'version': '1',
    'chainId': 42161  // Arbitrum
  },
  'message': {
    'agent': {...},
    'action': {...},
    'nonce': timestamp
  }
}
```

### 2. **Farcaster é’±åŒ…é›†æˆ**
- æ”¯æŒå†…ç½®é’±åŒ…çš„è‡ªåŠ¨æ£€æµ‹
- eth_accounts RPC æ–¹æ³•è·å–å½“å‰åœ°å€
- äº¤æ˜“é€šè¿‡ eth_sendTransaction æ–¹æ³•ç¡®è®¤

### 3. **äº¤æ˜“æµç¨‹**
```
ç”¨æˆ·ç‚¹å‡»ä¸‹å•
   â†“
HyperliquidTradingProvider.placeOrder()
   â†“
æ„é€  EIP-712 ç­¾åæ•°æ®
   â†“
è°ƒç”¨ Farcaster é’±åŒ…ç­¾å
   â†“
å‘é€ç­¾åäº¤æ˜“åˆ° Hyperliquid API
   â†“
Hyperliquid è¿”å›è®¢å• ID
   â†“
åˆ·æ–°è®¢å•åˆ—è¡¨æ˜¾ç¤º
```

## ğŸ“Š API ç«¯ç‚¹

| æ–¹æ³• | ç«¯ç‚¹ | ç”¨é€” |
|------|------|------|
| POST | /info | è·å–ç”¨æˆ·çŠ¶æ€ã€ä»·æ ¼æ•°æ®ã€å¸‚åœºä¿¡æ¯ |
| POST | /exchange | ä¸‹å•ã€å–æ¶ˆè®¢å•ã€æ›´æ–°æŒä»“ |

## ğŸš€ ä¸‹ä¸€æ­¥å·¥ä½œ

1. **å®Œæˆé’±åŒ…ç­¾åé›†æˆ**
   - é›†æˆ UserProvider çš„ signTypedData æ–¹æ³•
   - å®ç°çœŸå®çš„ EIP-712 ç­¾åéªŒè¯

2. **æµ‹è¯•å’ŒéªŒè¯**
   - åœ¨ Farcaster Mini App ç¯å¢ƒä¸­æµ‹è¯•ä¸‹å•
   - éªŒè¯äº¤æ˜“ç¡®è®¤æµç¨‹
   - æµ‹è¯•è®¢å•å–æ¶ˆåŠŸèƒ½

3. **å®Œå–„åŠŸèƒ½**
   - å®ç°å®æ—¶è®¢å•æ›´æ–°
   - æ·»åŠ æŒä»“è·Ÿè¸ª
   - å®ç°æ­¢æŸ/æ­¢ç›ˆåŠŸèƒ½

4. **æ€§èƒ½ä¼˜åŒ–**
   - WebSocket å®æ—¶æ•°æ®è®¢é˜…
   - æœ¬åœ°æ•°æ®ç¼“å­˜ç­–ç•¥
   - æ‰¹é‡ API è¯·æ±‚ä¼˜åŒ–

## ğŸ’¾ æ•°æ®å­˜å‚¨

ä½¿ç”¨ SharedPreferences å­˜å‚¨ï¼š
- å½“å‰äº¤æ˜“åœ°å€
- API å¯†é’¥ï¼ˆåŠ å¯†å­˜å‚¨ï¼‰
- åœ°å€æˆæƒä¿¡æ¯
- 30å¤©è¿‡æœŸæ—¶é—´

## ğŸ”’ å®‰å…¨è€ƒè™‘

1. **EIP-712 ç­¾åéªŒè¯**
   - æ‰€æœ‰äº¤æ˜“è¯·æ±‚éƒ½éœ€è¦ EIP-712 ç­¾å
   - ç­¾ååŒ…å« nonce é˜²æ­¢é‡æ”¾æ”»å‡»

2. **åœ°å€æˆæƒ**
   - æ¯ä¸ªåœ°å€éœ€è¦å•ç‹¬æˆæƒ
   - æˆæƒä¿¡æ¯å¸¦æœ‰è¿‡æœŸæ—¶é—´
   - æ”¯æŒæ’¤é”€æˆæƒ

3. **æ•æ„Ÿä¿¡æ¯**
   - API å¯†é’¥åº”è¯¥åŠ å¯†å­˜å‚¨
   - ä¸åœ¨æ—¥å¿—ä¸­æ‰“å°å®Œæ•´çš„ç§é’¥

## ğŸ“ ä¸»è¦æ–‡ä»¶

- `lib/services/hyperliquid_service.dart` - æ ¸å¿ƒæœåŠ¡
- `lib/providers/hyperliquid_trading_provider.dart` - äº¤æ˜“çŠ¶æ€ç®¡ç†
- `lib/models/hyperliquid_models.dart` - æ•°æ®æ¨¡å‹
- `lib/pages/trading_page.dart` - UI ç•Œé¢

## ğŸ¯ é›†æˆç‚¹

```dart
// åœ¨ main.dart ä¸­åˆå§‹åŒ–
await HyperliquidService().initialize();

// åœ¨ TradingPage ä¸­ä½¿ç”¨
final tradingProvider = Provider.of<HyperliquidTradingProvider>(context);
await tradingProvider.setTradingAddress(userProvider.currentUser!.walletAddress!);

// ä¸‹å•
await tradingProvider.placeOrder(
  symbol: 'ETH',
  size: 1.0,
  side: 'buy',
  price: 2000,
);
```

---

**çŠ¶æ€**: æ¶æ„å®Œæˆï¼Œå‡†å¤‡æµ‹è¯•é›†æˆ
**æ—¥æœŸ**: 2024-10-21
**ç‰ˆæœ¬**: 1.0 - åŸºç¡€æ¶æ„
